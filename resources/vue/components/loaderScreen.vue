<template>
    <div class="loading_indicator">
        <bubble-top-component></bubble-top-component>
        <div class="logo-wrapper">
            <svg id="loader" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                 style="display: block; shape-rendering: auto;" width="80px" height="80px" viewBox="0 0 100 100"
                 preserveAspectRatio="xMidYMid">
                <g transform="translate(50 50)">
                    <g>
                        <path
                            id="gear"
                            d="M29.491524206117255 -5.5 L37.491524206117255 -5.5 L37.491524206117255 5.5 L29.491524206117255 5.5 A30 30 0 0 1 24.742744050198738 16.964569457146712 L24.742744050198738 16.964569457146712 L30.399598299691117 22.621423706639092 L22.621423706639096 30.399598299691114 L16.964569457146716 24.742744050198734 A30 30 0 0 1 5.5 29.491524206117255 L5.5 29.491524206117255 L5.5 37.491524206117255 L-5.499999999999997 37.491524206117255 L-5.499999999999997 29.491524206117255 A30 30 0 0 1 -16.964569457146705 24.742744050198738 L-16.964569457146705 24.742744050198738 L-22.621423706639085 30.399598299691117 L-30.399598299691117 22.621423706639092 L-24.742744050198738 16.964569457146712 A30 30 0 0 1 -29.491524206117255 5.500000000000009 L-29.491524206117255 5.500000000000009 L-37.491524206117255 5.50000000000001 L-37.491524206117255 -5.500000000000001 L-29.491524206117255 -5.500000000000002 A30 30 0 0 1 -24.742744050198738 -16.964569457146705 L-24.742744050198738 -16.964569457146705 L-30.399598299691117 -22.621423706639085 L-22.621423706639092 -30.399598299691117 L-16.964569457146712 -24.742744050198738 A30 30 0 0 1 -5.500000000000011 -29.491524206117255 L-5.500000000000011 -29.491524206117255 L-5.500000000000012 -37.491524206117255 L5.499999999999998 -37.491524206117255 L5.5 -29.491524206117255 A30 30 0 0 1 16.964569457146702 -24.74274405019874 L16.964569457146702 -24.74274405019874 L22.62142370663908 -30.39959829969112 L30.399598299691117 -22.6214237066391 L24.742744050198738 -16.964569457146716 A30 30 0 0 1 29.491524206117255 -5.500000000000013 M0 -20A20 20 0 1 0 0 20 A20 20 0 1 0 0 -20"
                            fill="url(#linear-gradient)"></path>
                        <linearGradient id="linear-gradient">
                            <stop :offset="`0%`" stop-color="#C42FED"/>
                            <stop :offset="`100%`" stop-color="#639EFF"/>
                        </linearGradient>
                    </g>
                </g>
                <!-- [ldio] generated by https://loading.io/ -->
            </svg>

            <svg width="205" height="126" viewBox="0 0 117 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    id="bit"
                    d="M2.15625 3.86719H7.48828C9.91797 3.86719 11.6797 4.21484 12.7734 4.91016C13.875 5.59766 14.4258 6.69531 14.4258 8.20312C14.4258 9.22656 14.1836 10.0664 13.6992 10.7227C13.2227 11.3789 12.5859 11.7734 11.7891 11.9062V12.0234C12.875 12.2656 13.6562 12.7188 14.1328 13.3828C14.6172 14.0469 14.8594 14.9297 14.8594 16.0312C14.8594 17.5938 14.293 18.8125 13.1602 19.6875C12.0352 20.5625 10.5039 21 8.56641 21H2.15625V3.86719ZM5.78906 10.6523H7.89844C8.88281 10.6523 9.59375 10.5 10.0312 10.1953C10.4766 9.89062 10.6992 9.38672 10.6992 8.68359C10.6992 8.02734 10.457 7.55859 9.97266 7.27734C9.49609 6.98828 8.73828 6.84375 7.69922 6.84375H5.78906V10.6523ZM5.78906 13.5352V18H8.15625C9.15625 18 9.89453 17.8086 10.3711 17.4258C10.8477 17.043 11.0859 16.457 11.0859 15.668C11.0859 14.2461 10.0703 13.5352 8.03906 13.5352H5.78906ZM17.7812 21V3.86719H21.4141V21H17.7812ZM31.8359 21H28.2031V6.89062H23.5508V3.86719H36.4883V6.89062H31.8359V21Z"
                    fill="url(#paint0_linear)"
                />
                <path
                    id="firing"
                    d="M42.7305 21H39.1562V3.86719H48.9766V6.84375H42.7305V11.2617H48.543V14.2266H42.7305V21ZM51.8281 21V3.86719H55.4609V21H51.8281ZM62.9062 11.4727H64.0781C65.2266 11.4727 66.0742 11.2812 66.6211 10.8984C67.168 10.5156 67.4414 9.91406 67.4414 9.09375C67.4414 8.28125 67.1602 7.70312 66.5977 7.35938C66.043 7.01563 65.1797 6.84375 64.0078 6.84375H62.9062V11.4727ZM62.9062 14.4258V21H59.2734V3.86719H64.2656C66.5938 3.86719 68.3164 4.29297 69.4336 5.14453C70.5508 5.98828 71.1094 7.27344 71.1094 9C71.1094 10.0078 70.832 10.9062 70.2773 11.6953C69.7227 12.4766 68.9375 13.0898 67.9219 13.5352C70.5 17.3867 72.1797 19.875 72.9609 21H68.9297L64.8398 14.4258H62.9062ZM74.6172 21V3.86719H78.25V21H74.6172ZM97.2617 21H92.6445L85.1914 8.03906H85.0859C85.2344 10.3281 85.3086 11.9609 85.3086 12.9375V21H82.0625V3.86719H86.6445L94.0859 16.6992H94.168C94.0508 14.4727 93.9922 12.8984 93.9922 11.9766V3.86719H97.2617V21ZM107.59 11.3789H114.387V20.2617C113.285 20.6211 112.246 20.8711 111.27 21.0117C110.301 21.1602 109.309 21.2344 108.293 21.2344C105.707 21.2344 103.73 20.4766 102.363 18.9609C101.004 17.4375 100.324 15.2539 100.324 12.4102C100.324 9.64453 101.113 7.48828 102.691 5.94141C104.277 4.39453 106.473 3.62109 109.277 3.62109C111.035 3.62109 112.73 3.97266 114.363 4.67578L113.156 7.58203C111.906 6.95703 110.605 6.64453 109.254 6.64453C107.684 6.64453 106.426 7.17188 105.48 8.22656C104.535 9.28125 104.062 10.6992 104.062 12.4805C104.062 14.3398 104.441 15.7617 105.199 16.7461C105.965 17.7227 107.074 18.2109 108.527 18.2109C109.285 18.2109 110.055 18.1328 110.836 17.9766V14.4023H107.59V11.3789Z"
                    fill="white"
                />
                <path
                    id="freedom"
                    d="M5.64844 28.75H3.53906V36H1.69531V28.75H0.273438V27.8906L1.69531 27.3281V26.7656C1.69531 25.7448 1.9349 24.9896 2.41406 24.5C2.89323 24.0052 3.625 23.7578 4.60938 23.7578C5.25521 23.7578 5.89062 23.8646 6.51562 24.0781L6.03125 25.4688C5.57812 25.3229 5.14583 25.25 4.73438 25.25C4.31771 25.25 4.01302 25.3802 3.82031 25.6406C3.63281 25.8958 3.53906 26.2812 3.53906 26.7969V27.3594H5.64844V28.75ZM11.0078 27.2031C11.3776 27.2031 11.6823 27.2292 11.9219 27.2812L11.7422 28.9922C11.4818 28.9297 11.2109 28.8984 10.9297 28.8984C10.1953 28.8984 9.59896 29.138 9.14062 29.6172C8.6875 30.0964 8.46094 30.7188 8.46094 31.4844V36H6.625V27.3594H8.0625L8.30469 28.8828H8.39844C8.6849 28.3672 9.05729 27.9583 9.51562 27.6562C9.97917 27.3542 10.4766 27.2031 11.0078 27.2031ZM16.4766 36.1562C15.1328 36.1562 14.0807 35.7656 13.3203 34.9844C12.5651 34.1979 12.1875 33.1172 12.1875 31.7422C12.1875 30.3307 12.5391 29.2214 13.2422 28.4141C13.9453 27.6068 14.9115 27.2031 16.1406 27.2031C17.2812 27.2031 18.1823 27.5495 18.8438 28.2422C19.5052 28.9349 19.8359 29.888 19.8359 31.1016V32.0938H14.0781C14.1042 32.9323 14.3307 33.5781 14.7578 34.0312C15.1849 34.4792 15.7865 34.7031 16.5625 34.7031C17.0729 34.7031 17.5469 34.6562 17.9844 34.5625C18.4271 34.4635 18.901 34.3021 19.4062 34.0781V35.5703C18.9583 35.7839 18.5052 35.9349 18.0469 36.0234C17.5885 36.112 17.0651 36.1562 16.4766 36.1562ZM16.1406 28.5938C15.5573 28.5938 15.0885 28.7786 14.7344 29.1484C14.3854 29.5182 14.1771 30.0573 14.1094 30.7656H18.0312C18.0208 30.0521 17.849 29.513 17.5156 29.1484C17.1823 28.7786 16.724 28.5938 16.1406 28.5938ZM25.1953 36.1562C23.8516 36.1562 22.7995 35.7656 22.0391 34.9844C21.2839 34.1979 20.9062 33.1172 20.9062 31.7422C20.9062 30.3307 21.2578 29.2214 21.9609 28.4141C22.6641 27.6068 23.6302 27.2031 24.8594 27.2031C26 27.2031 26.901 27.5495 27.5625 28.2422C28.224 28.9349 28.5547 29.888 28.5547 31.1016V32.0938H22.7969C22.8229 32.9323 23.0495 33.5781 23.4766 34.0312C23.9036 34.4792 24.5052 34.7031 25.2812 34.7031C25.7917 34.7031 26.2656 34.6562 26.7031 34.5625C27.1458 34.4635 27.6198 34.3021 28.125 34.0781V35.5703C27.6771 35.7839 27.224 35.9349 26.7656 36.0234C26.3073 36.112 25.7839 36.1562 25.1953 36.1562ZM24.8594 28.5938C24.276 28.5938 23.8073 28.7786 23.4531 29.1484C23.1042 29.5182 22.8958 30.0573 22.8281 30.7656H26.75C26.7396 30.0521 26.5677 29.513 26.2344 29.1484C25.901 28.7786 25.4427 28.5938 24.8594 28.5938ZM33.0547 36.1562C31.9766 36.1562 31.1354 35.7656 30.5312 34.9844C29.9271 34.2031 29.625 33.1068 29.625 31.6953C29.625 30.2786 29.9297 29.1771 30.5391 28.3906C31.1536 27.599 32.0026 27.2031 33.0859 27.2031C34.2214 27.2031 35.0859 27.6224 35.6797 28.4609H35.7734C35.6849 27.8411 35.6406 27.3516 35.6406 26.9922V23.8438H37.4844V36H36.0469L35.7266 34.8672H35.6406C35.0521 35.7266 34.1901 36.1562 33.0547 36.1562ZM33.5469 34.6719C34.3021 34.6719 34.8516 34.4609 35.1953 34.0391C35.5391 33.612 35.7161 32.9219 35.7266 31.9688V31.7109C35.7266 30.6224 35.5495 29.849 35.1953 29.3906C34.8411 28.9323 34.2865 28.7031 33.5312 28.7031C32.8854 28.7031 32.388 28.9661 32.0391 29.4922C31.6901 30.013 31.5156 30.7578 31.5156 31.7266C31.5156 32.6849 31.6849 33.4167 32.0234 33.9219C32.362 34.4219 32.8698 34.6719 33.5469 34.6719ZM47.2734 31.6641C47.2734 33.0755 46.9115 34.1771 46.1875 34.9688C45.4635 35.7604 44.4557 36.1562 43.1641 36.1562C42.3568 36.1562 41.6432 35.974 41.0234 35.6094C40.4036 35.2448 39.9271 34.7214 39.5938 34.0391C39.2604 33.3568 39.0938 32.5651 39.0938 31.6641C39.0938 30.263 39.4531 29.1693 40.1719 28.3828C40.8906 27.5964 41.9036 27.2031 43.2109 27.2031C44.4609 27.2031 45.4505 27.6068 46.1797 28.4141C46.9089 29.2161 47.2734 30.2995 47.2734 31.6641ZM40.9844 31.6641C40.9844 33.6589 41.7214 34.6562 43.1953 34.6562C44.6536 34.6562 45.3828 33.6589 45.3828 31.6641C45.3828 29.6901 44.6484 28.7031 43.1797 28.7031C42.4089 28.7031 41.849 28.9583 41.5 29.4688C41.1562 29.9792 40.9844 30.7109 40.9844 31.6641ZM56.1719 36H54.3281V30.6719C54.3281 30.0104 54.2031 29.5182 53.9531 29.1953C53.7031 28.8672 53.3125 28.7031 52.7812 28.7031C52.0729 28.7031 51.5521 28.9349 51.2188 29.3984C50.8906 29.8568 50.7266 30.6224 50.7266 31.6953V36H48.8906V27.3594H50.3281L50.5859 28.4922H50.6797C50.9193 28.0807 51.2656 27.763 51.7188 27.5391C52.1771 27.3151 52.6797 27.2031 53.2266 27.2031C54.5547 27.2031 55.4349 27.6562 55.8672 28.5625H55.9922C56.2474 28.1354 56.6068 27.8021 57.0703 27.5625C57.5339 27.3229 58.0651 27.2031 58.6641 27.2031C59.6953 27.2031 60.4453 27.4635 60.9141 27.9844C61.388 28.5052 61.625 29.2995 61.625 30.3672V36H59.7891V30.6719C59.7891 30.0104 59.6615 29.5182 59.4062 29.1953C59.1562 28.8672 58.7656 28.7031 58.2344 28.7031C57.5208 28.7031 56.9974 28.9271 56.6641 29.375C56.3359 29.8177 56.1719 30.5 56.1719 31.4219V36Z"
                    fill="url(#paint0_linear)"
                />
                <path
                    id="play"
                    d="M71.5312 34.6719C71.9792 34.6719 72.4271 34.6016 72.875 34.4609V35.8438C72.6719 35.9323 72.4089 36.0052 72.0859 36.0625C71.7682 36.125 71.4375 36.1562 71.0938 36.1562C69.3542 36.1562 68.4844 35.2396 68.4844 33.4062V28.75H67.3047V27.9375L68.5703 27.2656L69.1953 25.4375H70.3281V27.3594H72.7891V28.75H70.3281V33.375C70.3281 33.8177 70.4375 34.1458 70.6562 34.3594C70.8802 34.5677 71.1719 34.6719 71.5312 34.6719ZM81.7734 31.6641C81.7734 33.0755 81.4115 34.1771 80.6875 34.9688C79.9635 35.7604 78.9557 36.1562 77.6641 36.1562C76.8568 36.1562 76.1432 35.974 75.5234 35.6094C74.9036 35.2448 74.4271 34.7214 74.0938 34.0391C73.7604 33.3568 73.5938 32.5651 73.5938 31.6641C73.5938 30.263 73.9531 29.1693 74.6719 28.3828C75.3906 27.5964 76.4036 27.2031 77.7109 27.2031C78.9609 27.2031 79.9505 27.6068 80.6797 28.4141C81.4089 29.2161 81.7734 30.2995 81.7734 31.6641ZM75.4844 31.6641C75.4844 33.6589 76.2214 34.6562 77.6953 34.6562C79.1536 34.6562 79.8828 33.6589 79.8828 31.6641C79.8828 29.6901 79.1484 28.7031 77.6797 28.7031C76.9089 28.7031 76.349 28.9583 76 29.4688C75.6562 29.9792 75.4844 30.7109 75.4844 31.6641ZM91.4297 36.1562C90.3359 36.1562 89.487 35.763 88.8828 34.9766H88.7734C88.8464 35.7057 88.8828 36.1484 88.8828 36.3047V39.8438H87.0469V27.3594H88.5312C88.5729 27.5208 88.6589 27.9062 88.7891 28.5156H88.8828C89.4557 27.6406 90.3151 27.2031 91.4609 27.2031C92.5391 27.2031 93.3776 27.5938 93.9766 28.375C94.5807 29.1562 94.8828 30.2526 94.8828 31.6641C94.8828 33.0755 94.5755 34.1771 93.9609 34.9688C93.3516 35.7604 92.5078 36.1562 91.4297 36.1562ZM90.9844 28.7031C90.2552 28.7031 89.7214 28.9167 89.3828 29.3438C89.0495 29.7708 88.8828 30.4531 88.8828 31.3906V31.6641C88.8828 32.7161 89.0495 33.4792 89.3828 33.9531C89.7161 34.4219 90.2604 34.6562 91.0156 34.6562C91.651 34.6562 92.1406 34.3958 92.4844 33.875C92.8281 33.3542 93 32.612 93 31.6484C93 30.6797 92.8281 29.9479 92.4844 29.4531C92.1458 28.9531 91.6458 28.7031 90.9844 28.7031ZM98.3516 36H96.5156V23.8438H98.3516V36ZM105.891 36L105.523 34.7969H105.461C105.044 35.3229 104.625 35.6823 104.203 35.875C103.781 36.0625 103.24 36.1562 102.578 36.1562C101.729 36.1562 101.065 35.9271 100.586 35.4688C100.112 35.0104 99.875 34.362 99.875 33.5234C99.875 32.6328 100.206 31.9609 100.867 31.5078C101.529 31.0547 102.536 30.8073 103.891 30.7656L105.383 30.7188V30.2578C105.383 29.7057 105.253 29.2943 104.992 29.0234C104.737 28.7474 104.339 28.6094 103.797 28.6094C103.354 28.6094 102.93 28.6745 102.523 28.8047C102.117 28.9349 101.727 29.0885 101.352 29.2656L100.758 27.9531C101.227 27.7083 101.74 27.5234 102.297 27.3984C102.854 27.2682 103.38 27.2031 103.875 27.2031C104.974 27.2031 105.802 27.4427 106.359 27.9219C106.922 28.401 107.203 29.1536 107.203 30.1797V36H105.891ZM103.156 34.75C103.823 34.75 104.357 34.5651 104.758 34.1953C105.164 33.8203 105.367 33.2969 105.367 32.625V31.875L104.258 31.9219C103.393 31.9531 102.763 32.099 102.367 32.3594C101.977 32.6146 101.781 33.0078 101.781 33.5391C101.781 33.9245 101.896 34.224 102.125 34.4375C102.354 34.6458 102.698 34.75 103.156 34.75ZM107.953 27.3594H109.953L111.711 32.2578C111.977 32.9557 112.154 33.612 112.242 34.2266H112.305C112.352 33.9401 112.438 33.5938 112.562 33.1875C112.688 32.776 113.349 30.8333 114.547 27.3594H116.531L112.836 37.1484C112.164 38.9453 111.044 39.8438 109.477 39.8438C109.07 39.8438 108.674 39.7995 108.289 39.7109V38.2578C108.565 38.3203 108.88 38.3516 109.234 38.3516C110.12 38.3516 110.742 37.8385 111.102 36.8125L111.422 36L107.953 27.3594Z"
                    fill="white"
                />
                <defs>
                    <linearGradient id="paint0_linear" x1="2.01482e-07" y1="24" x2="30.0732" y2="32.0091"
                                    gradientUnits="userSpaceOnUse">
                        <stop stop-color="#C42FED"/>
                        <stop offset="0.99971" stop-color="#639EFF"/>
                    </linearGradient>
                    <linearGradient id="paint1_linear" x1="3.43064e-07" y1="42" x2="45.4846" y2="62.6257"
                                    gradientUnits="userSpaceOnUse">
                        <stop stop-color="#C42FED"/>
                        <stop offset="0.99971" stop-color="#639EFF"/>
                    </linearGradient>
                </defs>
            </svg>
            <transition @enter="titleEnter" @before-enter="titleBeforeEnter">
                <div v-if="title" class="preloader-game">
                    <p class="preloader-game__title">{{ title }}</p>
                </div>
            </transition>
        </div>
    </div>
</template>

<script>
import BubbleTopComponent from "./buble/BubbleTopComponent";
import {gsap, Back, Circ} from "gsap";

const gear_tl = gsap.timeline({yoyo: true, repeat: -1});

export default {
    name: "loaderScreen",
    data() {
        return {
            loaded: 0,
            loading: null,
            loadStyle: {
                width: '0%'
            },
        }
    },
    watch: {
        loaded() {
            this.loadStyle.width = `${this.loaded}%`;
            if (this.loaded === 1) {
                gsap.to('#loader', {
                    duration: 1.8, alpha: 1, x: 0,
                    ease: "power1.inOut"
                })

                gear_tl.fromTo("#gear", {
                    rotation: 0,
                    transformOrigin: "center"
                }, {duration: 2.1, rotation: 360, transformOrigin: "center", repeat: -1, ease: 'linear'}, 0);

            }
            if (this.loaded === 10) {
                gsap.to("#bit", {duration: 1.5, alpha: 1, x: 0, ease: "power1.inOut"});
            }
            if (this.loaded === 30) {
                gsap.to("#firing", {duration: 1.5, alpha: 1, x: 0, ease: "power1.inOut"});
            }
            if (this.loaded === 20) {
                gsap.to("#freedom", {duration: 1.5, alpha: 1, x: 0, ease: "power1.inOut"});
            }
            if (this.loaded === 40) {
                gsap.to("#play", {duration: 1.5, alpha: 1, x: 0, ease: "power1.inOut"});
            }
        }
    },
    computed: {
        title() {
            return this.$store.state.preloader.title || null
        }
    },
    methods: {
        removeScrolling() {
            this.body.css('overflow', 'hidden');
        },
        startLoading() {
            const el = document.body;
            el.classList.add('fancybox-active', 'compensate-for-scrollbar');
            this.loading = setInterval(this.load, 20);
            this.updateStatus()
        },
        load() {
            this.loaded < 100 ? this.loaded++ : this.doneLoading();
        },
        doneLoading() {
            clearInterval(this.loading);
        },
        updateStatus() {
            this.$store.commit('preloader/SET_TIMEOUT', setTimeout(() => this.$store.commit('preloader/close_loader'), 2500))
        },
        titleEnter(el){
            gsap.set(el, {alpha: 0, y: 20});
        },
        titleBeforeEnter(el){
            gsap.to(el, {duration: 1.5, alpha: 0.9, y: 0, ease: "power3.inOut"});
        }
    },
    mounted() {
        gsap.set("#bit, #firing, #freedom, #play, #loader", {alpha: 0, x: 150});
        // gsap.set("#gear", {alpha: 0});

        this.startLoading();
    },
    components: {
        BubbleTopComponent
    },
}
</script>

<style scoped>
.logo-wrapper {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
}

.preloader-game {
    position: absolute;
    width: 100%;
    bottom: -270px;
    padding-top: 2px;
    padding-bottom: 6px;
    display: flex;
    align-items: flex-start;
    padding-left: 81px;
    height: 300px;
}

.preloader-game__title {
    font-size: 23px;
    text-transform: uppercase;
    font-weight: 400;
    text-align: center;
    background: linear-gradient(
        99.8deg, #C42FED, #639EFF, #639EFF, #C42FED);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    color: #0B2349;

    width: 100%;
}

.loading_indicator {
    position: fixed;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background-color: #09051D;
    z-index: 99999;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

</style>
